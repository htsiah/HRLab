@(person:Person, manager:Person, leaveprofiles: List[LeaveProfile])(implicit session: play.api.mvc.Session)

@pluginjs = {
	<script src="@routes.Assets.at("layout/jquery-ui/javascripts/jquery-ui-1.10.3.full.min.js")"></script>
	<script src="@routes.Assets.at("layout/jquery-ui/javascripts/jquery.ui.touch-punch.min.js")"></script>
}

@inlinejs = {
	<script src="@routes.Assets.at("javascripts/common.dialogbox.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("javascripts/person.myprofileview.js")" type="text/javascript"></script>
}

@pluginstyle = {
	<link rel="stylesheet" href="@routes.Assets.at("layout/jquery-ui/stylesheets/jquery-ui-1.10.3.full.min.css")" />
}

@inlinestyle = {}

@pbuttons = {
	<a href="@routes.PersonController.myprofileedit" class="btn btn-sm btn btn-block">Edit</a>	
}

@lbuttons = {
	<a href="@routes.LeaveProfileController.myprofilecreate" class="btn btn-sm btn btn-block">Add Leave Profile</a>	
}

@contentRow(label: String, contentVal: String, cssClass:String="") = {
	@if(contentVal.trim() == "") {
		<dl class="dl-horizontal"><dt><label>@label</label></dt><dd class="@cssClass">&nbsp</dd></dl>
	} else {
		<dl class="dl-horizontal"><dt><label>@label</label></dt><dd class="@cssClass">@contentVal</dd></dl>
	}
}

@layout.ace.main(session.get("company").get + " | HRLab.my",pluginjs,inlinejs,pluginstyle,inlinestyle) {

	<div class="page-header">
		<h1>My Profile <small><i class="ace-icon fa fa-angle-double-right"></i> Personal Info</small></h1>
	</div>
	<div class="tabbable">
		<ul class="nav nav-tabs" id="myTab">
			<li class="active">
				<a data-toggle="tab" href="#home">
					General
				</a>
			</li>

			<li class="">
				<a data-toggle="tab" href="#messages">
					Leave Profile(s)
				</a>
			</li>
		</ul>

		<div class="tab-content">
			<div id="home" class="tab-pane fade active in">
				@if(session.get("roles").get.contains("Admin")) {
					<div class="row">
						<div class="col-sm-9">
							@contentRow("First name", person.p.fn)
							@contentRow("Last name", person.p.ln)
							@contentRow("Email", person.p.em)
							@contentRow("Position type", person.p.pt)
							@contentRow("Manager", manager.p.fn + " " + manager.p.ln)
							@contentRow("Gender", person.p.g)
							@contentRow("Marital Status", person.p.ms)
							@contentRow("Department", person.p.dpm)
							@contentRow("Office", person.p.off)
							@contentRow("Employment start date", person.p.edat.get.toLocalDate().toString())
							<dl class="dl-horizontal">
								<dt><label>Work day</label></dt>
								<dd>
									@if(person.wd.wd1==true) {Monday}
									@if(person.wd.wd2==true) {Tuesday}
									@if(person.wd.wd3==true) {Wednesday}
									@if(person.wd.wd4==true) {Thursday}
									@if(person.wd.wd5==true) {Friday}
									@if(person.wd.wd6==true) {Saturday}
									@if(person.wd.wd6==true) {Sunday}
								</dd>
							</dl>
							@contentRow("Role", if(person.p.rl.toString=="List()"){""}else{person.p.rl.mkString(",")})
						</div>@** /.col-xs-9 **@
						<div class="col-sm-3">
							@pbuttons
						</div>@** /.col-xs-3 **@
					</div>@** /.row **@ 
				} else {
					<div class="row">
						<div class="col-sm-12">
							@contentRow("First name", person.p.fn)
							@contentRow("Last name", person.p.ln)
							@contentRow("Email", person.p.em)
							@contentRow("Position type", person.p.pt)
							@contentRow("Manager", manager.p.fn + " " + manager.p.ln)
							@contentRow("Gender", person.p.g)
							@contentRow("Marital Status", person.p.ms)
							@contentRow("Department", person.p.dpm)
							@contentRow("Office", person.p.off)
							@contentRow("Employment start date", person.p.edat.get.toLocalDate().toString())
							<dl class="dl-horizontal">
								<dt><label>Work day</label></dt>
								<dd>
									@if(person.wd.wd1==true) {Monday}
									@if(person.wd.wd2==true) {Tuesday}
									@if(person.wd.wd3==true) {Wednesday}
									@if(person.wd.wd4==true) {Thursday}
									@if(person.wd.wd5==true) {Friday}
									@if(person.wd.wd6==true) {Saturday}
									@if(person.wd.wd6==true) {Sunday}
								</dd>
							</dl>
							@contentRow("Role", if(person.p.rl.toString=="List()"){""}else{person.p.rl.mkString(",")})
						</div>@** /.col-xs-12 **@
					</div>@** /.row **@ 
				}
			</div>

			<div id="messages" class="tab-pane fade">
				<div class="row">
					@if(session.get("roles").get.contains("Admin")) {
						<div class="col-sm-9">
							<div class="table-responsive">
								<table id="leavetable" class="table table-striped table-bordered table-hover">
									<thead><tr>
										<th>Leave Type</th>
										<th>Entitlement</th>
										<th>Earned</th>
										<th>Adjustment</th>
										<th>Carry Forward</th>
										<th>Total Utilized</th>
										<th>Total Expired</th>
										<th>Closing Balance</th>
										<th width="100px">&nbsp;</th>
									</tr></thead>
									<tbody>
										@leaveprofiles.map{ leaveprofile =>
											<tr>
												<td>@leaveprofile.lt</td>
												<td>@leaveprofile.cal.ent</td>
												<td>@leaveprofile.cal.ear</td>
												<td>@leaveprofile.cal.adj</td>
												<td>@leaveprofile.cal.cf</td>
												<td>@(leaveprofile.cal.cfuti + leaveprofile.cal.uti)</td>
												<td>@leaveprofile.cal.cfexp</td>
												<td>@leaveprofile.cal.cbal</td>
												<td class="center">
													<div class="btn-group">
														<a class="btn btn-xs btn-success" title="View" href="@routes.LeaveProfileController.myprofileview(leaveprofile._id.stringify)">
															<i class="ace-icon fa fa-search-plus bigger-120"></i>
														</a>
														<a class="btn btn-xs btn-info" title="Edit" href="@routes.LeaveProfileController.myprofileedit(leaveprofile._id.stringify)">
															<i class="ace-icon fa fa-pencil bigger-120"></i>
														</a>
														<a class="btn btn-xs btn-danger" href="javascript:onDeleteLeaveProfile('@leaveprofile._id.stringify', '@leaveprofile.lt', '@person._id.stringify')" title="Delete">
															<i class="ace-icon fa fa-trash-o bigger-120"></i>
														</a>
													</div>
												</td>
											</tr>
										}
									</tbody>
								</table>
							</div>@** /.table-responsive **@
						</div>@** /.col-xs-9 **@
						<div class="col-sm-3">
							@lbuttons
						</div>@** /.col-xs-3 **@
					} else {
						<div class="col-sm-12">
							<div class="table-responsive">
								<table id="leavetable" class="table table-striped table-bordered table-hover">
									<thead><tr>
										<th>Leave Type</th>
										<th>Entitlement</th>
										<th>Earned</th>
										<th>Adjustment</th>
										<th>Carry Forward</th>
										<th>Total Utilized</th>
										<th>Total Expired</th>
										<th>Balance</th>
										<th width="100px">&nbsp;</th>
									</tr></thead>
									<tbody>
										@leaveprofiles.map{ leaveprofile =>
											<tr>
												<td>@leaveprofile.lt</td>
												<td>@leaveprofile.cal.ent</td>
												<td>@leaveprofile.cal.ear</td>
												<td>@leaveprofile.cal.adj</td>
												<td>@leaveprofile.cal.cf</td>
												<td>@(leaveprofile.cal.cfuti + leaveprofile.cal.uti)</td>
												<td>@leaveprofile.cal.cfexp</td>
												<td>@leaveprofile.cal.bal</td>
												<td class="center">
													<div class="btn-group">
														<a class="btn btn-xs btn-success" title="View" href="@routes.LeaveProfileController.myprofileview(leaveprofile._id.stringify)">
															<i class="ace-icon fa fa-search-plus bigger-120"></i>
														</a>
													</div>
												</td>
											</tr>
										}
									</tbody>
								</table>
							</div>@** /.table-responsive **@
						</div>@** /.col-xs-12 **@
					}
				</div>@** /.row **@ 
			</div>
		</div>
	</div>
	@layout.ace.dialogbox("dialog-message", Html("<div class='alert alert-info bigger-110'><p>Selected leave profile will be permanently deleted and cannot be recovered.</p><p>Notes:<ul><li>Leave that linked to deleted leave profile will be locked.</li><li>No workflow action can be perform on lock document.</li></ul></p></div>"))
}