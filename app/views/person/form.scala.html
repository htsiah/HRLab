@import helper._
@import reactivemongo.bson.BSONObjectID

@(person:Form[Person], persons:List[Person], departments:List[String], offices:List[String], isLastAdmin:Boolean=false, oid:String="")(implicit session: play.api.mvc.Session)

@pageheader = {
	<div class="page-header">
		@if(oid==""){
			<h1>Company <small><i class="ace-icon fa fa-angle-double-right"></i> Staff Directory <i class="ace-icon fa fa-angle-double-right"></i> Staff <i class="ace-icon fa fa-angle-double-right"></i> New</small></h1>
		} else {
			<h1>Company <small><i class="ace-icon fa fa-angle-double-right"></i> Staff Directory <i class="ace-icon fa fa-angle-double-right"></i> @person("p")("fn").value @person("p")("ln").value <i class="ace-icon fa fa-angle-double-right"></i> General</small></h1>
		}
	</div>
}

@pluginjs = {
	<script src="@routes.Assets.at("layout/ace/js/date-time/bootstrap-datepicker.min.js")" type="text/javascript"></script>
	<script src="@routes.Assets.at("layout/jquery.validate/jquery.validate.min.js")"></script>
}

@inlinejs = {
	<script src="@routes.Assets.at("javascripts/person.form.js")" type="text/javascript"></script>
}

@pluginstyle = {
	<link href="@routes.Assets.at("layout/ace/css/datepicker.css")" rel="stylesheet" media="screen">
	<link href="@routes.Assets.at("stylesheets/common.jquery.validation.css")" rel="stylesheet" media="screen">
}

@inlinestyle = {}

@buttons = {
	<a href="javascript:$('#personform').submit();" class="btn btn-sm btn btn-block">Save</a>
	<a href="javascript:history.back()" class="btn btn-sm btn btn-block">Back</a>	
}

@radioSelected(value: Option[String], valueCheck: String) = {
	@if(value != None){
		@if(value.get == valueCheck){
			checked="checked"
		}
	}
}

@layout.ace.main93(session.get("company").get + " | HRSifu.my",pageheader,pluginjs,inlinejs,pluginstyle,inlinestyle,buttons) {

	@helper.form(
		action = (
			if(oid=="")
				routes.PersonController.insert
			else
				routes.PersonController.update(oid)
		), 
		'id -> "personform"
	) {
		
		@inputText(person("p")("fn"), '_label->"First name", '_class->"dl-horizontal", '_showConstraints->false, 'class->"form-control")
		@inputText(person("p")("ln"), '_label->"Last name", '_class->"dl-horizontal", '_showConstraints->false, 'class->"form-control")
		@if(oid=="") {	
			@input(person("p")("em"), '_label->"Email", '_class->"dl-horizontal", '_showConstraints->false) { (id, name, value, args) =>
    		<div class="input-group">
    			<input type="text" name="@name" id="@id" class="form-control" value="@value" @toHtmlArgs(args)>
				<span class="input-group-addon">
					<i class="ace-icon fa fa-envelope"></i>
				</span>
			</div>
			}
		} else {
			<dl class="dl-horizontal">
				<dt><label>Email</label></dt>
				<dd class="">@person("p")("em").value</dd>
			</dl>
		}
		@select(person("p")("pt"), options = Seq("Manager"->"Manager","Executive"->"Executive"), '_label -> "Position",'_default -> "Please select", '_class->"dl-horizontal", 'class->"form-control")
		@select(person("p")("mgrid"), options=persons.map(person=>person._id.stringify->{person.p.fn + " " + person.p.ln}),
			'_default -> "Please select",
			'_label -> "Manager",
			'_showConstraints -> false,
			'_class->"dl-horizontal", 
			'class->"form-control")	
		@select(person("p")("g"), options = Seq("Male"->"Male","Female"->"Female"), '_label -> "Gender",'_default -> "Please select", '_class->"dl-horizontal", 'class->"form-control")
		@select(person("p")("ms"), options = Seq("Single"->"Single","Married"->"Married"), '_label -> "Marital Status",'_default -> "Please select", '_class->"dl-horizontal", 'class->"form-control")
		@select(person("p")("dpm"), options = options(departments.map(department=>department)), '_label -> "Department",'_default -> "Please select", '_class->"dl-horizontal", 'class->"form-control")
		@select(person("p")("off"), options = options(offices.map(office=>office)), '_label -> "Office",'_default -> "Please select", '_class->"dl-horizontal", 'class->"form-control")
		@input(person("p")("edat"), '_label->"Employment start date", '_class->"dl-horizontal", '_showConstraints->false) { (id, name, value, args) =>
    	<div class="input-group">
    		<input type="text" name="@name" id="@id" class="form-control date-picker" value="@value" data-date-format="yyyy-mm-dd" @toHtmlArgs(args)>
				<span class="input-group-addon">
					<i class="fa fa-calendar bigger-110"></i>
				</span>
			</div>
		}
		<dl class="dl-horizontal">
			<dt><label>Work day</label></dt>
			<dd>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd1" id="wd_w1" class="ace" @radioSelected(person("wd")("wd1").value, "true")>
						<span class="lbl"> 1</span>
					</label>
				</div>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd2" id="wd_w2" class="ace" @radioSelected(person("wd")("wd2").value, "true")>
						<span class="lbl"> 2</span>
					</label>
				</div>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd3" id="wd_w3" class="ace" @radioSelected(person("wd")("wd3").value, "true")>
						<span class="lbl"> 3</span>
					</label>
				</div>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd4" id="wd_w4" class="ace" @radioSelected(person("wd")("wd4").value, "true")>
						<span class="lbl"> 4</span>
					</label>
				</div>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd5" id="wd_w5" class="ace" @radioSelected(person("wd")("wd5").value, "true")>
						<span class="lbl"> 5</span>
					</label>
				</div>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd6" id="wd_w6" class="ace" @radioSelected(person("wd")("wd6").value, "true")>
						<span class="lbl"> 6</span>
					</label>
				</div>
				<div class="checkbox" style="display: inline-block;">
					<label>
						<input type="checkbox" value="true" name="wd.wd7" id="wd_w7" class="ace" @radioSelected(person("wd")("wd7").value, "true")>
						<span class="lbl"> 7</span>
					</label>
				</div>
			</dd>
		</dl>

		<dl class="dl-horizontal">
			<dt><label>Role</label></dt>
			<dd>
				@if(isLastAdmin) {
					<dd class="">Only admin</dd>
				} else {
					<div class="checkbox" style="display: inline-block;">
						<label>
							<input type="checkbox" value="Admin" name="rl.admin" id="rl_admin" class="ace" @radioSelected(person("p")("rl").value, "Admin")>
							<span class="lbl"> Admin</span>
						</label>
					</div>
				}
			</dd>
		</dl>

		<div class="hidden">
			@inputText(person("_id"),'type -> "hidden")
			@inputText(person("p")("rl"),'type -> "hidden")
			@inputText(person("sys")("eid"),'type -> "hidden")
			@inputText(person("sys")("cdat"),'type -> "hidden")
			@inputText(person("sys")("mdat"),'type -> "hidden")
			@inputText(person("sys")("mby"),'type -> "hidden")
			@inputText(person("sys")("ddat"),'type -> "hidden")
			@inputText(person("sys")("dby"),'type -> "hidden")
			@inputText(person("sys")("ll"),'type -> "hidden")
			@if(oid!="") {
				@inputText(person("p")("em"),'type -> "hidden")
			}	
		</div>

  }
}