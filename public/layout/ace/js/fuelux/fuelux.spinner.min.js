!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){var i=t.fn.spinbox,s=function(i,s){this.$element=t(i),this.$element.find(".btn").on("click",function(t){t.preventDefault()}),this.options=t.extend({},t.fn.spinbox.defaults,s),this.$input=this.$element.find(".spinbox-input"),this.$element.on("focusin.fu.spinbox",this.$input,t.proxy(this.changeFlag,this)),this.$element.on("focusout.fu.spinbox",this.$input,t.proxy(this.change,this)),this.$element.on("keydown.fu.spinbox",this.$input,t.proxy(this.keydown,this)),this.$element.on("keyup.fu.spinbox",this.$input,t.proxy(this.keyup,this)),this.bindMousewheelListeners(),this.mousewheelTimeout={},this.options.hold?(this.$element.on("mousedown.fu.spinbox",".spinbox-up",t.proxy(function(){this.startSpin(!0)},this)),this.$element.on("mouseup.fu.spinbox",".spinbox-up, .spinbox-down",t.proxy(this.stopSpin,this)),this.$element.on("mouseout.fu.spinbox",".spinbox-up, .spinbox-down",t.proxy(this.stopSpin,this)),this.$element.on("mousedown.fu.spinbox",".spinbox-down",t.proxy(function(){this.startSpin(!1)},this))):(this.$element.on("click.fu.spinbox",".spinbox-up",t.proxy(function(){this.step(!0)},this)),this.$element.on("click.fu.spinbox",".spinbox-down",t.proxy(function(){this.step(!1)},this))),this.switches={count:1,enabled:!0},this.switches.speed="medium"===this.options.speed?300:"fast"===this.options.speed?100:500,this.lastValue=this.options.value,this.render(),this.options.disabled&&this.disable()};s.prototype={constructor:s,destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){t(this).attr("value",t(this).val())}),this.$element[0].outerHTML},render:function(){var i=this.parseInput(this.$input.val()),s="";""!==i&&0===this.options.value?this.value(i):this.output(this.options.value),this.options.units.length&&t.each(this.options.units,function(t,i){i.length>s.length&&(s=i)})},output:function(t,i){return t=(t+"").split(".").join(this.options.decimalMark),i=i||!0,i&&this.$input.val(t),t},parseInput:function(t){return t=(t+"").split(this.options.decimalMark).join(".")},change:function(){var t=this.parseInput(this.$input.val())||"";this.options.units.length||"."!==this.options.decimalMark?t=this.parseValueWithUnit(t):t/1?t=this.options.value=this.checkMaxMin(t/1):(t=this.checkMaxMin(t.replace(/[^0-9.-]/g,"")||""),this.options.value=t/1),this.output(t),this.changeFlag=!1,this.triggerChangedEvent()},changeFlag:function(){this.changeFlag=!0},stopSpin:function(){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.count=1,this.triggerChangedEvent())},triggerChangedEvent:function(){var t=this.value();t!==this.lastValue&&(this.lastValue=t,this.$element.trigger("changed.fu.spinbox",this.output(t,!1)))},startSpin:function(i){if(!this.options.disabled){var s=this.switches.count;1===s?(this.step(i),s=1):s=3>s?1.5:8>s?2.5:4,this.switches.timeout=setTimeout(t.proxy(function(){this.iterate(i)},this),this.switches.speed/s),this.switches.count++}},iterate:function(t){this.step(t),this.startSpin(t)},step:function(t){var i,s,e,n;if(this.changeFlag&&this.change(),e=this.options.value,n=t?this.options.max:this.options.min,t?n>e:e>n){var o=e+(t?1:-1)*this.options.step;this.options.step%1!==0&&(i=(this.options.step+"").split(".")[1].length,s=Math.pow(10,i),o=Math.round(o*s)/s),this.value((t?o>n:n>o)?n:o)}else if(this.options.cycle){var h=t?this.options.min:this.options.max;this.value(h)}},value:function(t){return t||0===t?this.options.units.length||"."!==this.options.decimalMark?(this.output(this.parseValueWithUnit(t+(this.unit||""))),this):!isNaN(parseFloat(t))&&isFinite(t)?(this.options.value=t/1,this.output(t+(this.unit?this.unit:"")),this):void 0:(this.changeFlag&&this.change(),this.unit?this.options.value+this.unit:this.output(this.options.value,!1))},isUnitLegal:function(i){var s;return t.each(this.options.units,function(t,e){return e.toLowerCase()===i.toLowerCase()?(s=i.toLowerCase(),!1):void 0}),s},parseValueWithUnit:function(t){var i=t.replace(/[^a-zA-Z]/g,""),s=t.replace(/[^0-9.-]/g,"");return i&&(i=this.isUnitLegal(i)),this.options.value=this.checkMaxMin(s/1),this.unit=i||void 0,this.options.value+(i||"")},checkMaxMin:function(t){return isNaN(parseFloat(t))?t:(t<=this.options.max&&t>=this.options.min||(t=t>=this.options.max?this.options.max:this.options.min),t)},disable:function(){this.options.disabled=!0,this.$element.addClass("disabled"),this.$input.attr("disabled",""),this.$element.find("button").addClass("disabled")},enable:function(){this.options.disabled=!1,this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$element.find("button").removeClass("disabled")},keydown:function(t){var i=t.keyCode;38===i?this.step(!0):40===i&&this.step(!1)},keyup:function(t){var i=t.keyCode;(38===i||40===i)&&this.triggerChangedEvent()},bindMousewheelListeners:function(){var i=this.$input.get(0);i.addEventListener?(i.addEventListener("mousewheel",t.proxy(this.mousewheelHandler,this),!1),i.addEventListener("DOMMouseScroll",t.proxy(this.mousewheelHandler,this),!1)):i.attachEvent("onmousewheel",t.proxy(this.mousewheelHandler,this))},mousewheelHandler:function(t){var i=window.event||t,s=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail)),e=this;return clearTimeout(this.mousewheelTimeout),this.mousewheelTimeout=setTimeout(function(){e.triggerChangedEvent()},300),this.step(s>0?!0:!1),i.preventDefault?i.preventDefault():i.returnValue=!1,!1}},t.fn.spinbox=function(i){var e,n=Array.prototype.slice.call(arguments,1),o=this.each(function(){var o=t(this),h=o.data("fu.spinbox"),a="object"==typeof i&&i;h||o.data("fu.spinbox",h=new s(this,a)),"string"==typeof i&&(e=h[i].apply(h,n))});return void 0===e?o:e},t.fn.spinbox.defaults={value:0,min:0,max:999,step:1,hold:!0,speed:"medium",disabled:!1,cycle:!1,units:[],decimalMark:"."},t.fn.spinbox.Constructor=s,t.fn.spinbox.noConflict=function(){return t.fn.spinbox=i,this},t(document).on("mousedown.fu.spinbox.data-api","[data-initialize=spinbox]",function(i){var s=t(i.target).closest(".spinbox");s.data("fu.spinbox")||s.spinbox(s.data())}),t(function(){t("[data-initialize=spinbox]").each(function(){var i=t(this);i.data("fu.spinbox")||i.spinbox(i.data())})})});